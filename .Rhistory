ggplot(Conso, aes(prob_revente))+geom_histogram(binwidth = .01)
ggplot(Conso, aes(ConsentementàPayer,prob_revente))+geom_point()+geom_smooth()
#indépendance entre prix de réserve et probabilité de revendre
#ce sont les deux caractéristiques de base des conso.
#on verra ensuite l'hypothèse de leur correlation
ggplot(Conso, aes(ConsentementàPayer))+geom_histogram(binwidth = 1)
#consommateur
Conso<- data.frame(value = round(rnorm(10000, mean = 50, sd = 20)),0) %>%
rename(ConsentementàPayer=value)%>%
rownames_to_column(var="id")
foo<-rnorm(10000,mean=0.3, sd=0.02)%>%as.data.frame()%>%rename(prob_revente=1)
Conso=cbind(Conso, foo) %>%
mutate(prob_revente=prob_revente+log10(ConsentementàPayer)/50)
ggplot(Conso, aes(prob_revente))+geom_histogram(binwidth = .01)
ggplot(Conso, aes(ConsentementàPayer,prob_revente))+geom_point()+geom_smooth()
library(tidyverse)
#consommateur
Conso<- data.frame(value = round(rnorm(10000, mean = 50, sd = 20)),0) %>%
mutate(value=ifelse(value<0,0,value))%>%
rename(ConsentementàPayer=value)%>%
rownames_to_column(var="id")
foo<-rnorm(10000,mean=0.3, sd=0.02)%>%as.data.frame()%>%rename(prob_revente=1)
Conso=cbind(Conso, foo) %>%
mutate(prob_revente=prob_revente+log10(ConsentementàPayer)/50)
ggplot(Conso, aes(prob_revente))+geom_histogram(binwidth = .01)
ggplot(Conso, aes(ConsentementàPayer,prob_revente))+geom_point()+geom_smooth()
#indépendance entre prix de réserve et probabilité de revendre
#ce sont les deux caractéristiques de base des conso.
#on verra ensuite l'hypothèse de leur correlation
ggplot(Conso, aes(ConsentementàPayer))+geom_histogram(binwidth = 1)
library(tidyverse)
#consommateur
Conso<- data.frame(value = round(rnorm(10000, mean = 50, sd = 20)),0) %>%
mutate(value=ifelse(value<0,0,value))%>%
rename(ConsentementàPayer=value)%>%
rownames_to_column(var="id")
foo<-rnorm(10000,mean=0.3, sd=0.02)%>%as.data.frame()%>%rename(prob_revente=1)
Conso=cbind(Conso, foo) %>%
mutate(prob_revente=prob_revente+log10(ConsentementàPayer)/50)
ggplot(Conso, aes(prob_revente))+geom_histogram(binwidth = .01)
ggplot(Conso, aes(ConsentementàPayer,prob_revente))+geom_point()+geom_smooth()
#indépendance entre prix de réserve et probabilité de revendre
#ce sont les deux caractéristiques de base des conso.
#on verra ensuite l'hypothèse de leur correlation
ggplot(Conso, aes(ConsentementàPayer))+geom_histogram(binwidth = 1)
library(tidyverse)
#consommateur
Conso<- data.frame(value = round(rnorm(10000, mean = 30, sd = 20)),0) %>%
mutate(value=ifelse(value<0,0,value))%>%
rename(ConsentementàPayer=value)%>%
rownames_to_column(var="id")
foo<-rnorm(10000,mean=0.3, sd=0.02)%>%as.data.frame()%>%rename(prob_revente=1)
Conso=cbind(Conso, foo) %>%
mutate(prob_revente=prob_revente+log10(ConsentementàPayer)/50)
ggplot(Conso, aes(prob_revente))+geom_histogram(binwidth = .01)
ggplot(Conso, aes(ConsentementàPayer,prob_revente))+geom_point()+geom_smooth()
#indépendance entre prix de réserve et probabilité de revendre
#ce sont les deux caractéristiques de base des conso.
#on verra ensuite l'hypothèse de leur correlation
ggplot(Conso, aes(ConsentementàPayer))+geom_histogram(binwidth = 1)
#entreprise
FC<- 5000
VC<- 4
foo<-Conso %>%
group_by(ConsentementàPayer)%>%
summarise(n=n())%>%
mutate(max=sum(n),
demande=max-cumsum(n),
CA=demande*ConsentementàPayer,
TC=(demande*VC)+FC,
Profit=CA-TC)
ggplot(foo, aes(x=ConsentementàPayer, y=demande))+geom_point()+geom_line()
ggplot(foo, aes(x=ConsentementàPayer, y=CA))+geom_point()+geom_line()
ggplot(foo, aes(x=ConsentementàPayer, y=TC))+geom_point()+geom_line()
ggplot(foo, aes(x=ConsentementàPayer, y=Profit))+geom_point()+geom_line()
#décision
Px_optimum_0<-foo$ConsentementàPayer[which.max(foo$Profit)]
#entreprise
FC<- 10000
VC<- 4
foo<-Conso %>%
group_by(ConsentementàPayer)%>%
summarise(n=n())%>%
mutate(max=sum(n),
demande=max-cumsum(n),
CA=demande*ConsentementàPayer,
TC=(demande*VC)+FC,
Profit=CA-TC)
ggplot(foo, aes(x=ConsentementàPayer, y=demande))+geom_point()+geom_line()
ggplot(foo, aes(x=ConsentementàPayer, y=CA))+geom_point()+geom_line()
ggplot(foo, aes(x=ConsentementàPayer, y=TC))+geom_point()+geom_line()
ggplot(foo, aes(x=ConsentementàPayer, y=Profit))+geom_point()+geom_line()
#décision
Px_optimum_0<-foo$ConsentementàPayer[which.max(foo$Profit)]
library(tidyverse)
#consommateur
Conso<- data.frame(value = round(rnorm(10000, mean = 30, sd = 20),0)) %>%
mutate(value=ifelse(value<0,0,value))%>%
rename(ConsentementàPayer=value)%>%
rownames_to_column(var="id")
foo<-rnorm(10000,mean=0.3, sd=0.02)%>%as.data.frame()%>%rename(prob_revente=1)
Conso=cbind(Conso, foo) %>%
mutate(prob_revente=prob_revente+log10(ConsentementàPayer)/50)
ggplot(Conso, aes(prob_revente))+geom_histogram(binwidth = .01)
ggplot(Conso, aes(ConsentementàPayer,prob_revente))+geom_point()+geom_smooth()
#indépendance entre prix de réserve et probabilité de revendre
#ce sont les deux caractéristiques de base des conso.
#on verra ensuite l'hypothèse de leur correlation
ggplot(Conso, aes(ConsentementàPayer))+geom_histogram(binwidth = 1)
View(p)
Conso<-Conso %>%
mutate(c_t1=ifelse(ConsentementàPayer>Px_optimum_0,1,0),
v_t1=ifelse(c_t1==1,rbinom(1, size = 1, prob=prob_revente)
,0))
View(Conso)
v_t1=ifelse(c_t1==1 & prob_revente>.3,1,0)
Conso<-Conso %>%
mutate(c_t1=ifelse(ConsentementàPayer>Px_optimum_0,1,0),
v_t1=ifelse(c_t1==1 & prob_revente>.3,1,0))
View(Conso)
Conso<-Conso %>%
mutate(c_t1=ifelse(ConsentementàPayer>Px_optimum_0,1,0),
v_t1=ifelse(c_t1==1 & prob_revente>mean(prob_revente),1,0))
table(Conso$c_t1)
table(Conso$v_t1)
View(Conso)
#consommateur
Conso<- data.frame(value = round(rnorm(10000, mean = 30, sd = 20),0)) %>%
mutate(value=ifelse(value<0,0,value))%>%
rename(ConsentementàPayer=value)%>%
rownames_to_column(var="id")
foo<-rnorm(10000,mean=0.3, sd=0.02)%>%
as.data.frame()%>%
rename(prob_revente=1)
Conso=cbind(Conso, foo) %>%
mutate(prob_revente=prob_revente+log10(ConsentementàPayer+1)/50)
ggplot(Conso, aes(prob_revente))+geom_histogram(binwidth = .01)
ggplot(Conso, aes(ConsentementàPayer,prob_revente))+geom_point()+geom_smooth()
#indépendance entre prix de réserve et probabilité de revendre
#ce sont les deux caractéristiques de base des conso.
#on verra ensuite l'hypothèse de leur correlation
ggplot(Conso, aes(ConsentementàPayer))+geom_histogram(binwidth = 1)
#entreprise
FC<- 10000
VC<- 4
foo<-Conso %>%
group_by(ConsentementàPayer)%>%
summarise(n=n())%>%
mutate(max=sum(n),
demande=max-cumsum(n),
CA=demande*ConsentementàPayer,
TC=(demande*VC)+FC,
Profit=CA-TC)
ggplot(foo, aes(x=ConsentementàPayer, y=demande))+geom_point()+geom_line()
ggplot(foo, aes(x=ConsentementàPayer, y=CA))+geom_point()+geom_line()
ggplot(foo, aes(x=ConsentementàPayer, y=TC))+geom_point()+geom_line()
ggplot(foo, aes(x=ConsentementàPayer, y=Profit))+geom_point()+geom_line()
#décision
Px_optimum_0<-foo$ConsentementàPayer[which.max(foo$Profit)]
#décision consommateur à t1
Conso_revente<-mean(Conso$prob_revente)
Conso<-Conso %>%
mutate(c_t1=ifelse(ConsentementàPayer>Px_optimum_0,1,0),
v_t1=ifelse(c_t1==1 & prob_revente>Conso_revente,1,0))
table(Conso$v_t1)
View(Conso)
Conso<-Conso %>%
mutate(c_t1=ifelse(ConsentementàPayer>Px_optimum_0,1,0),
v_t1=ifelse(c_t1==1 & prob_revente>Conso_revente,1,0),
p_t1=0.30*Px_optimum_0+0.1*(ConsentementàPayer-Px_optimum_0))
ggplot(Conso, aes(p_t1))+geom_histogram()
p_t1=ifelse(v_t1==1, 0.30*Px_optimum_0+0.1*(ConsentementàPayer-Px_optimum_0), NA)
Conso<-Conso %>%
mutate(c_t1=ifelse(ConsentementàPayer>Px_optimum_0,1,0),
v_t1=ifelse(c_t1==1 & prob_revente>Conso_revente,1,0),
p_t1=ifelse(v_t1==1, 0.30*Px_optimum_0+0.1*(ConsentementàPayer-Px_optimum_0), NA))
ggplot(Conso, aes(p_t1))+geom_histogram()
ggplot(Conso, aes(p_t1))+geom_histogram()
table(Conso$v_t1)
#décision consommateur à t1
Conso_revente<-mean(Conso$prob_revente)
Conso<-Conso %>%
mutate(c_t1=ifelse(ConsentementàPayer>Px_optimum_0,1,0),
v_t1=ifelse(c_t1==1 & prob_revente>Conso_revente,1,0),
p_t1=ifelse(v_t1==1, 0.30*Px_optimum_0+0.1*(ConsentementàPayer-Px_optimum_0), NA))
ggplot(Conso, aes(p_t1))+geom_histogram()
table(Conso$v_t1)
#décision consommateur à t1
#b) ils achète pour revendre
#c) ils n'achètent pas
View(Conso)
Conso=cbind(Conso, foo) %>%
mutate(prob_revente=prob_revente+log10(ConsentementàPayer+1)/50,
ConsentementàPayerOccasion=0.3*ConsentementàPayerNeuf+runif(1, -5,5))
#consommateur
Conso<- data.frame(value = round(rnorm(10000, mean = 30, sd = 20),0)) %>%
mutate(value=ifelse(value<0,0,value))%>%
rename(ConsentementàPayerNeuf=value)%>%
rownames_to_column(var="id")
foo<-rnorm(10000,mean=0.3, sd=0.02)%>%
as.data.frame()%>%
rename(prob_revente=1)
Conso=cbind(Conso, foo) %>%
mutate(prob_revente=prob_revente+log10(ConsentementàPayer+1)/50,
ConsentementàPayerOccasion=0.3*ConsentementàPayerNeuf+runif(1, -5,5))
Conso=cbind(Conso, foo) %>%
mutate(prob_revente=prob_revente+log10(ConsentementàPayerNeuf+1)/50,
ConsentementàPayerOccasion=0.3*ConsentementàPayerNeuf+runif(1, -5,5))
#consommateur
Conso<- data.frame(value = round(rnorm(10000, mean = 30, sd = 20),0)) %>%
mutate(value=ifelse(value<0,0,value))%>%
rename(ConsentementàPayerNeuf=value)%>%
rownames_to_column(var="id")
foo<-rnorm(10000,mean=0.3, sd=0.02)%>%
as.data.frame()%>%
rename(prob_revente=1)
Conso=cbind(Conso, foo) %>%
mutate(prob_revente=prob_revente+log10(ConsentementàPayerNeuf+1)/50)
Conso$rnd<- sample(10000, size = nrow(Conso), replace = TRUE)
Conso$rnd<- sample(1, size = nrow(Conso), replace = TRUE)
Conso$rnd<- sample(10, size = nrow(Conso), replace = TRUE)
Conso$rnd<- rnorm(size = nrow(Conso), mean=0.3, sd=0.02,  replace = TRUE)
Conso$rnd<- rnorm(nrow(Conso), mean=0.3, sd=0.02,  replace = TRUE)
Conso$rnd<- rnorm(nrow(Conso), mean=0.3, sd=0.02)
Conso$ConsentementàPayerOccasion<- rnorm(nrow(Conso), mean=0.3, sd=0.02)
Conso$ConsentementàPayerOccasion<- rnorm(nrow(Conso), mean=0.25, sd=0.5)
Conso$ConsentementàPayerOccasion<- rnorm(nrow(Conso), mean=0.25, sd=0.05)
Conso$ConsentementàPayerOccasion<- ConsentementàPayerNeuf*Conso$ConsentementàPayerOccasion
Conso$ConsentementàPayerOccasion<- Conso$ConsentementàPayerNeuf*Conso$ConsentementàPayerOccasion
ggplot(Conso, aes(ConsentementàPayerOccasion))+geom_histogram(binwidth = .01)
ggplot(Conso, aes(ConsentementàPayerOccasion))+geom_histogram(binwidth = 1)
#consommateurs
Conso<- data.frame(value = round(rnorm(10000, mean = 30, sd = 20),0)) %>%
mutate(CàPNeuf=value)%>%
mutate(CàPNeuf=ifelse(CàPNeuf<0,0,value))%>%
rownames_to_column(var="id")
Conso$Décôte<- rnorm(nrow(Conso), mean=Décote, sd=0.05)
Décote=.25
Conso$Décôte<- rnorm(nrow(Conso), mean=Décote, sd=0.05)
Conso$ConsentementàPayerOccasion<- Conso$CàPNeuf*Conso$Décôte
ggplot(Conso, aes(ConsentementàPayerOccasion))+geom_histogram(binwidth = 1)
library(tidyverse)
Décote=.25
#consommateurs
Conso<- data.frame(value = round(rnorm(10000, mean = 30, sd = 20),0)) %>%
mutate(CàPNeuf=value)%>%
mutate(CàPNeuf=ifelse(CàPNeuf<0,0,value))%>%
rownames_to_column(var="id")
Conso$Décôte<- rnorm(nrow(Conso), mean=Décote, sd=0.05)
Conso$ConsentementàPayerOccasion<- Conso$CàPNeuf*Conso$Décôte
ggplot(Conso, aes(ConsentementàPayerOccasion))+geom_histogram(binwidth = 1)
ggplot(Conso, aes(ConsentementàPayer,prob_revente))+geom_point()+geom_smooth()
Conso$ConsentementàPayerOccasion<- Conso$value*Conso$Décôte
ggplot(Conso, aes(ConsentementàPayerOccasion))+geom_histogram(binwidth = 1)
Conso$ConsentementàPayerOccasion<-ifelse(Conso$ConsentementàPayerOccasion<0,0,Conso$ConsentementàPayerOccasion)
ggplot(Conso, aes(ConsentementàPayerOccasion))+geom_histogram(binwidth = 1)
View(Conso)
ggplot(Conso, aes(ConsentementàPayer,Décôte))+geom_point()+geom_smooth()
ggplot(Conso, aes(CàPNeuf,Décôte))+geom_point()+geom_smooth()
library(tidyverse)
Décote=.25
#consommateurs
Conso<- data.frame(value = round(rnorm(10000, mean = 30, sd = 20),0)) %>%
mutate(CàPNeuf=value)%>%
mutate(CàPNeuf=ifelse(CàPNeuf<0,0,value))%>%
rownames_to_column(var="id")
Conso$Décôte<- rnorm(nrow(Conso), mean=Décote, sd=0.05)
Conso$CàPOccasion<- Conso$value*Conso$Décôte
Conso$CàPOccasion<-ifelse(Conso$CàPOccasion<0,0,Conso$CàPOccasion)
ggplot(Conso, aes(CàPOccasion))+geom_histogram(binwidth = 1)
ggplot(Conso, aes(CàPNeuf,Décôte))+geom_point()+geom_smooth()
#indépendance entre prix de réserve et probabilité de revendre
#ce sont les deux caractéristiques de base des conso.
#on verra ensuite l'hypothèse de leur correlation
ggplot(Conso, aes(ConsentementàPayer))+geom_histogram(binwidth = 1)
#indépendance entre prix de réserve et probabilité de revendre
#ce sont les deux caractéristiques de base des conso.
#on verra ensuite l'hypothèse de leur correlation
ggplot(Conso, aes(CàPOccasion))+geom_histogram(binwidth = 1)
ggplot(Conso, aes(CàPOccasion,Décôte))+geom_point()+geom_smooth()
#entreprise
FC<- 10000
VC<- 4
MarchePrimaire<-Conso %>%
group_by(ConsentementàPayer)%>%
summarise(n=n())%>%
mutate(max=sum(n),
demande=max-cumsum(n),
CA=demande*ConsentementàPayer,
TC=(demande*VC)+FC,
Profit=CA-TC)
#entreprise
FC<- 10000
VC<- 4
MarchePrimaire<-Conso %>%
group_by(CàPNeuf)%>%
summarise(n=n())%>%
mutate(max=sum(n),
demande=max-cumsum(n),
CA=demande*CàPNeuf,
TC=(demande*VC)+FC,
Profit=CA-TC)
ggplot(MarchePrimaire, aes(x=CàPNeuf, y=demande))+geom_point()+geom_line()
ggplot(MarchePrimaire, aes(x=CàPNeuf, y=CA))+geom_point()+geom_line()
ggplot(MarchePrimaire, aes(x=CàPNeuf, y=TC))+geom_point()+geom_line()
ggplot(MarchePrimaire, aes(x=CàPNeuf, y=Profit))+geom_point()+geom_line()
#décision
Px_optimum_0<-MarchePrimaire$CàPNeuf[which.max(foo$Profit)]
#décision consommateur à t1
Conso_revente<-mean(Conso$Décôte)
Conso<-Conso %>%
mutate(c_t1=ifelse(CàPNeuf>Px_optimum_0,1,0),
v_t1=ifelse(c_t1==1 & prob_revente>Conso_revente,1,0),
p_t1=ifelse(v_t1==1, 0.30*Px_optimum_0+0.1*(CàPNeuf-Px_optimum_0), NA))
Px_optimum_0<-MarchePrimaire$CàPNeuf[which.max(foo$Profit)]
ggplot(MarchePrimaire, aes(x=CàPNeuf, y=Profit))+geom_point()+geom_line()
Px_optimum_0<-MarchePrimaire$CàPNeuf[which.max(MarchePrimaire$Profit)]
#décision consommateur à t1
Conso_revente<-mean(Conso$Décôte)
Conso<-Conso %>%
mutate(c_t1=ifelse(CàPNeuf>Px_optimum_0,1,0),
v_t1=ifelse(c_t1==1 & prob_revente>Conso_revente,1,0),
p_t1=ifelse(v_t1==1, 0.30*Px_optimum_0+0.1*(CàPNeuf-Px_optimum_0), NA))
Conso<-Conso %>%
mutate(c_t1=ifelse(CàPNeuf>Px_optimum_0,1,0),
v_t1=ifelse(c_t1==1 & Décote >Conso_revente,1,0),
p_t1=ifelse(v_t1==1, 0.30*Px_optimum_0+0.1*(CàPNeuf-Px_optimum_0), NA))
ggplot(Conso, aes(p_t1))+geom_histogram()
table(Conso$v_t1)
View(Conso)
OffreSecondaire<-Conso %>%filter(is.na(p_t1))
View(OffreSecondaire)
OffreSecondaire<-Conso %>%filter(!is.na(p_t1))
View(OffreSecondaire)
MarcheSecondaire<-OffreSecondaire %>%
group_by(P_t1)%>%
summarise(n=n())%>%
mutate(max=sum(n),
demande=max-cumsum(n))
ggplot(MarcheSecondaire, aes(x=p_t1, y=demande))+geom_point()+geom_line()
MarcheSecondaire<-OffreSecondaire %>%
group_by(p_t1)%>%
summarise(n=n())%>%
mutate(max=sum(n),
demande=max-cumsum(n))
ggplot(MarcheSecondaire, aes(x=p_t1, y=demande))+geom_point()+geom_line()
View(MarcheSecondaire)
MarcheSecondaire<-OffreSecondaire %>%
group_by(p_t1)%>%
summarise(n=n())%>%
mutate(max=sum(n))
ggplot(MarcheSecondaire, aes(x=p_t1, y=n))+geom_point()+geom_line()
View(MarcheSecondaire)
View(MarcheSecondaire)
Conso<-Conso %>%
mutate(a_t1=ifelse(CàPNeuf>Px_optimum_0,1,0), #
v_t1=ifelse(a_t1==1 & Décote < Conso_revente,1,0),
p_t1=ifelse(v_t1==1, 0.30*Px_optimum_0+0.1*(CàPNeuf-Px_optimum_0), NA))
ggplot(Conso, aes(p_t1))+geom_histogram()
ggplot(Conso, aes(p_t1))+geom_histogram()
Conso<-Conso %>%
mutate(a_t1=ifelse(CàPNeuf>Px_optimum_0,1,0), #
v_t1=ifelse(a_t1==1 & Décote < Conso_revente,1,0),
p_t1=ifelse(v_t1==1, 0.30*Px_optimum_0+0.1*(CàPNeuf-Px_optimum_0), NA))
Conso<-Conso %>%
mutate(a_t1=ifelse(CàPNeuf>Px_optimum_0,1,0),
p_t1=ifelse(a_t1==1, 0.30*Px_optimum_0+0.1*(CàPNeuf-Px_optimum_0), NA))
library(tidyverse)
Décote=.25
#consommateurs
Conso<- data.frame(value = round(rnorm(10000, mean = 30, sd = 20),0)) %>%
mutate(CàPNeuf=value)%>%
mutate(CàPNeuf=ifelse(CàPNeuf<0,0,value))%>%
rownames_to_column(var="id")
Conso$Décôte<- rnorm(nrow(Conso), mean=Décote, sd=0.05)
Conso$CàPOccasion<- Conso$value*Conso$Décôte
Conso$CàPOccasion<-ifelse(Conso$CàPOccasion<0,0,Conso$CàPOccasion)
ggplot(Conso, aes(CàPOccasion))+geom_histogram(binwidth = 1)
ggplot(Conso, aes(CàPOccasion,Décôte))+geom_point()+geom_smooth()
#indépendance entre prix de réserve et probabilité de revendre
#ce sont les deux caractéristiques de base des conso.
#on verra ensuite l'hypothèse de leur correlation
ggplot(Conso, aes(CàPOccasion))+geom_histogram(binwidth = 1)
#entreprise
FC<- 10000
VC<- 4
MarchePrimaire<-Conso %>%
group_by(CàPNeuf)%>%
summarise(n=n())%>%
mutate(max=sum(n),
demande=max-cumsum(n),
CA=demande*CàPNeuf,
TC=(demande*VC)+FC,
Profit=CA-TC)
ggplot(MarchePrimaire, aes(x=CàPNeuf, y=demande))+geom_point()+geom_line()
ggplot(MarchePrimaire, aes(x=CàPNeuf, y=CA))+geom_point()+geom_line()
ggplot(MarchePrimaire, aes(x=CàPNeuf, y=TC))+geom_point()+geom_line()
ggplot(MarchePrimaire, aes(x=CàPNeuf, y=Profit))+geom_point()+geom_line()
#décision
Px_optimum_0<-MarchePrimaire$CàPNeuf[which.max(MarchePrimaire$Profit)]
#décision consommateur à t1
Décote_revente<-mean(Conso$Décôte)
Conso<-Conso %>%
mutate(a_t1=ifelse(CàPNeuf>Px_optimum_0,1,0),
p_t1=ifelse(a_t1==1, 0.30*Px_optimum_0+0.1*(CàPNeuf-Px_optimum_0), NA))
ggplot(Conso, aes(p_t1))+geom_histogram()
table(Conso$v_t1)
OffreSecondaire<-Conso %>%filter(!is.na(p_t1))
MarcheSecondaire<-OffreSecondaire %>%
group_by(p_t1)%>%
summarise(n=n())%>%
mutate(max=sum(n))
ggplot(MarcheSecondaire, aes(x=p_t1, y=n))+geom_point()+geom_line()
,
Conso<-Conso %>%
mutate(a_t1=ifelse(CàPNeuf>Px_optimum_0,1,0),
p_t1=ifelse(a_t1==1, Décote*Px_optimum_0+0.1*(CàPNeuf-Px_optimum_0), NA))
View(OffreSecondaire)
ggplot(Conso, aes(x=p_t1, y=CàPNeuf))+geom_point()+geom_line()
Conso<-Conso %>%
mutate(a_t1=ifelse(CàPNeuf>Px_optimum_0,1,0),
p_t1=ifelse(a_t1==1, Décote*Px_optimum_0, NA))
ggplot(Conso, aes(p_t1))+geom_histogram()
ggplot(Conso, aes(x=p_t1, y=CàPNeuf))+geom_point()+geom_line()
#décision consommateur à t1
Décote_revente<-mean(Conso$Décôte)
library(tidyverse)
Décote=.25
#consommateurs
Conso<- data.frame(value = round(rnorm(10000, mean = 30, sd = 20),0)) %>%
mutate(CàPNeuf=value)%>%
mutate(CàPNeuf=ifelse(CàPNeuf<0,0,value))%>%
rownames_to_column(var="id")
Conso$Décôte<- rnorm(nrow(Conso), mean=Décote, sd=0.05)
Conso$CàPOccasion<- Conso$value*Conso$Décôte
Conso$CàPOccasion<-ifelse(Conso$CàPOccasion<0,0,Conso$CàPOccasion)
ggplot(Conso, aes(CàPOccasion))+geom_histogram(binwidth = 1)
ggplot(Conso, aes(CàPOccasion,Décôte))+geom_point()+geom_smooth()
#indépendance entre prix de réserve et probabilité de revendre
#ce sont les deux caractéristiques de base des conso.
#on verra ensuite l'hypothèse de leur correlation
ggplot(Conso, aes(CàPOccasion))+geom_histogram(binwidth = 1)
#entreprise
FC<- 10000
VC<- 4
MarchePrimaire<-Conso %>%
group_by(CàPNeuf)%>%
summarise(n=n())%>%
mutate(max=sum(n),
demande=max-cumsum(n),
CA=demande*CàPNeuf,
TC=(demande*VC)+FC,
Profit=CA-TC)
ggplot(MarchePrimaire, aes(x=CàPNeuf, y=demande))+geom_point()+geom_line()
ggplot(MarchePrimaire, aes(x=CàPNeuf, y=CA))+geom_point()+geom_line()
ggplot(MarchePrimaire, aes(x=CàPNeuf, y=TC))+geom_point()+geom_line()
ggplot(MarchePrimaire, aes(x=CàPNeuf, y=Profit))+geom_point()+geom_line()
#décision
Px_optimum_0<-MarchePrimaire$CàPNeuf[which.max(MarchePrimaire$Profit)]
Conso1<-Conso %>%
mutate(a_t1=ifelse(CàPNeuf>Px_optimum_0,1,0),
p_t1=ifelse(a_t1==1, Décote*Px_optimum_0, NA))
ggplot(Conso, aes(x=p_t1, y=CàPNeuf))+geom_point()+geom_line()
ggplot(Conso1, aes(x=p_t1, y=CàPNeuf))+geom_point()+geom_line()
ggplot(Conso1, aes(p_t1))+geom_histogram()
View(Conso1)
Conso1<-Conso %>%
mutate(a_t1=ifelse(CàPNeuf>Px_optimum_0,1,0),
p_t1=ifelse(a_t1==1, Décôte*Px_optimum_0, NA))
ggplot(Conso1, aes(p_t1))+geom_histogram()
ggplot(Conso1, aes(x=p_t1, y=CàPNeuf))+geom_point()+geom_line()
ggplot(Conso1, aes(x=p_t1, y=CàPNeuf))+geom_point()+geom_smooth()
ggplot(Conso1, aes(x=CàPNeuf, y=p_t1))+geom_point()+geom_smooth()
Conso1<-Conso %>%
mutate(a_t1=ifelse(CàPNeuf>Px_optimum_0,1,0),
p_t1=ifelse(a_t1==1, Décôte*Px_optimum_0+0.1(CàNeuf-Px_optimum_0), NA))
Conso1<-Conso %>%
mutate(a_t1=ifelse(CàPNeuf>Px_optimum_0,1,0),
p_t1=ifelse(a_t1==1, Décôte*Px_optimum_0+0.1(CàPNeuf-Px_optimum_0), NA))
#décision consommateur à t1
Décote_revente<-mean(Conso$Décôte)
Conso1<-Conso %>%
mutate(a_t1=ifelse(CàPNeuf>Px_optimum_0,1,0),
p_t1=ifelse(a_t1==1, Décôte*Px_optimum_0+0.1(CàPNeuf-Px_optimum_0), NA))
Conso1<-Conso %>%
mutate(a_t1=ifelse(CàPNeuf>Px_optimum_0,1,0),
p_t1=ifelse(a_t1==1, (Décôte*Px_optimum_0+0.1*(CàPNeuf-Px_optimum_0)), NA))
View(Conso1)
ggplot(Conso1, aes(p_t1))+geom_histogram()
ggplot(Conso1, aes(x=CàPNeuf, y=p_t1))+geom_point()+geom_smooth()
OffreSecondaire<-Conso1 %>%filter(!is.na(p_t1))
View(OffreSecondaire)
MarcheSecondaire<-OffreSecondaire %>%
group_by(p_t1)%>%
summarise(n=n())%>%
mutate(max=sum(n))
ggplot(MarcheSecondaire, aes(x=p_t1, y=n))+geom_point()+geom_line()
Conso1<-Conso %>%
mutate(a_t1=ifelse(CàPNeuf>Px_optimum_0,1,0),
p_t1=ifelse(a_t1==1, round(Décôte*Px_optimum_0+0.1*(CàPNeuf-Px_optimum_0),0), NA))
ggplot(Conso1, aes(p_t1))+geom_histogram()
ggplot(Conso1, aes(x=CàPNeuf, y=p_t1))+geom_point()+geom_smooth()
OffreSecondaire<-Conso1 %>%filter(!is.na(p_t1))
MarcheSecondaire<-OffreSecondaire %>%
group_by(p_t1)%>%
summarise(n=n())%>%
mutate(max=sum(n))
ggplot(MarcheSecondaire, aes(x=p_t1, y=n))+geom_point()+geom_line()
ggplot(MarcheSecondaire, aes(x=p_t1, y=n))+geom_point()+geom_line()
View(OffreSecondaire)
View(MarcheSecondaire)
View(Conso1)
